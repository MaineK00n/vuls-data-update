package vulnerability

import (
	"cmp"
	"slices"

	ecosystemTypes "github.com/MaineK00n/vuls-data-update/pkg/extract/types/data/detection/ecosystem"
	contentTypes "github.com/MaineK00n/vuls-data-update/pkg/extract/types/data/vulnerability/content"
)

type Vulnerability struct {
	Content     contentTypes.Content        `json:"content,omitempty"`
	Ecosystems  []ecosystemTypes.Ecosystem  `json:"ecosystems,omitempty"`
	Ecosystems2 []ecosystemTypes.Ecosystem2 `json:"ecosystems2,omitempty"`
}

func (v *Vulnerability) Sort() {
	v.Content.Sort()

	slices.Sort(v.Ecosystems)
}

func Compare(x, y Vulnerability) int {
	return cmp.Or(
		contentTypes.Compare(x.Content, y.Content),
		slices.Compare(x.Ecosystems, y.Ecosystems),
	)
}
